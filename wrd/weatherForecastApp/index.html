<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .zadatak {
        border: 1px solid black;
        width: 60%;
      }
      .gradListItem {
        text-align: center;
        background-color: rgb(255, 208, 139);
        padding: 10px;
      }
      .gradListItem:hover{
        background-color: rgb(255, 148, 72);
        transition: 400ms;
      }
      #strelica{
        width: 70px;
        margin: 20px;
      }
      .strelica{
        width: 70px;
        margin: 20px;
      }
      table,thead,th,tr,td{
        border: 1px solid black;
      }
      table{
        width: 100%;
      }
      .prognozaVremena{
        width: 100%;
      }

      .propeller{
        animation-name: rotacija;
        animation-iteration-count: infinite;
        animation-timing-function: linear;
      }

      @keyframes rotacija {
        from {
          rotate: 0deg
        }
        to{
          rotate: 360deg;
        }
        
      }
    </style>
  </head>
  <body onload="prikaziGradove()">
    <div class="zadatak">
      <h1>Zadatak 1: Dodaj grad</h1>
      <label>Naziv grada</label><br />
      <input type="text" id="unosGrada" />
      <br />
      <button onclick="dodajGradULocalStorage()">Dodaj grad</button>
    </div>

    <div class="zadatak">
      <h1>Zadatak 2: Prikazi gradove</h1>
      <div id="gradoviPlaceholder"></div>
      <button onclick="obrisiSveGradove()">Obrisi sve gradove</button>
    </div>

    <div class="prikazOdabranogGrada zadatak" id="prikazOdabranogGrada">
        <h1>Zadatak 3: Prikazi odabrani grad</h1>
        <div>
            <div>RB grada</div>
            <input id="odabrani-id">
        </div>
        <div>
            <div>Naziv grada</div>
            <input id="odabrani-naziv">
        </div>
        <button onclick="obrisiGrad()">Obrisi grad</button>
        <button onclick="pogledajPrognozu()">Pogledaj prognozu</button>
    </div>

    <div class="trenutnoVrijeme zadatak">
        <h1>Zadatak 4: Trenutno vrijeme</h1>
        <div class="grupa">
            <label>temperatura = </label>
            <input type="number" id="textTemp" disabled>
        </div>

        <div class="grupa">
            <label>Vjetar m/s </label>
            <input type="number" id="textWindSpeed" disabled>
        </div>

        <div class="grupa">
            <label>Vjetar smjer Deg </label>
            <input type="number" id="textWindDeg" disabled>
        </div>

        <img id="strelica" src="strelica.jpg">

        <div id="svg-div" style="color: blue">
            <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#"
                xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="14mm" height="31mm"
                viewBox="0 0 14 31" version="1.1" id="svg1986" inkscape:version="0.92.4 (5da689c313, 2019-01-14)"
                sodipodi:docname="Thermometer.svg">
                <defs id="defs1980" />
                <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0"
                    inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="2.8" inkscape:cx="-96.243744"
                    inkscape:cy="91.797364" inkscape:document-units="mm" inkscape:current-layer="layer1"
                    showgrid="false" width="36mm" inkscape:window-width="1920" inkscape:window-height="1139"
                    inkscape:window-x="1024" inkscape:window-y="26" inkscape:window-maximized="1" />
                <metadata id="metadata1983">
                    <rdf:RDF>
                        <cc:Work rdf:about="">
                            <dc:format>image/svg+xml</dc:format>
                            <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                            <dc:title />
                        </cc:Work>
                    </rdf:RDF>
                </metadata>
                <g inkscape:label="Ebene 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-266)">
                    <g id="g873">
                        <path sodipodi:nodetypes="cccccccc" inkscape:connector-curvature="0" id="path1933-9-9"
                            d="m 5.7239904,280.26803 v 8.47837 c -0.731926,0.44852 -1.178451,1.24493 -1.179294,2.10335 -1.2e-5,1.364 1.105731,2.46974 2.469728,2.46972 1.363998,2e-5 2.469741,-1.10572 2.469729,-2.46972 -0.0012,-0.85798 -0.447742,-1.65383 -1.179294,-2.10212 v -8.4796 z"
                            style="opacity:1;fill:currentColor;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.35687089;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:fill markers stroke" />
                        <g id="g858">
                            <path
                                style="opacity:1;fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.35687089;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:fill markers stroke"
                                d="m 7.0144244,270.25344 c -0.712686,0 -1.290434,0.57774 -1.290434,1.29043 v 17.20253 a 2.4697054,2.4697054 0 0 0 -1.179294,2.10335 2.4697054,2.4697054 0 0 0 2.469728,2.46972 2.4697054,2.4697054 0 0 0 2.469729,-2.46972 2.4697054,2.4697054 0 0 0 -1.179294,-2.10212 v -17.20376 c 0,-0.71269 -0.577748,-1.29043 -1.290435,-1.29043 z"
                                id="path1933-9" inkscape:connector-curvature="0" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,275.59349 H 10.470804" id="path814" inkscape:connector-curvature="0"
                                sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,282.15565 H 10.470804" id="path814-0"
                                inkscape:connector-curvature="0" sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,277.23403 H 10.470804" id="path814-2"
                                inkscape:connector-curvature="0" sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,273.95294 H 10.470803" id="path814-9"
                                inkscape:connector-curvature="0" sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,280.51512 H 10.470804" id="path814-05"
                                inkscape:connector-curvature="0" sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,283.79621 H 10.470803" id="path814-6"
                                inkscape:connector-curvature="0" sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,285.43674 H 11.441464" id="path814-1-4"
                                inkscape:connector-curvature="0" sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,278.87458 H 11.441464" id="path814-1-9"
                                inkscape:connector-curvature="0" sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#000000;stroke-width:0.37568492px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                                d="M 9.1644617,272.3124 H 11.441463" id="path814-1-1"
                                inkscape:connector-curvature="0" sodipodi:nodetypes="cc" />
                            <path
                                style="fill:none;stroke:#ffffff;stroke-width:0.27738255;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                                d="m 5.358402,290.85284 c 0.148998,0.7487 0.585742,1.32226 1.381078,1.53639 v 0 0"
                                id="path1476" inkscape:connector-curvature="0" sodipodi:nodetypes="cccc" />
                        </g>
                    </g>
                </g>
            </svg>
        </div>
    </div>

    <div class="prognozaVremena zadatak">
        <h1>Zadatak 5: Prikazi vremensku prognozu za odabrani grad</h1>
        <table id="table">
            <thead>
              <th>Time</th>
              <th>Temperature</th>
              <th>Description</th>
              <th>Humidity</th>
              <th>Wind speed	</th>
              <th>Wind direction	</th>
              <th>Pressure</th>
            </thead>

        </table>
    </div>

    <script src="kolekcija.js"></script>

    <script>

      let gradovi = new Kolekcija("gradovi");
      let brojac=0;


      function dodajGradULocalStorage() {
        let grad = document.getElementById("unosGrada").value;
        if(!grad) return;
        gradovi.add(grad);
        brojac++;
        gradovi.updateBrojac();
        prikaziGradove();
      }

      function prikaziGradove(){
        let listaGradova = document.getElementById("gradoviPlaceholder");
        listaGradova.innerHTML='';
        for(let i = 0; i < gradovi.getAll().length; i++){
          listaGradova.innerHTML+= `<p class="gradListItem" onclick="popuniPoljaInformacijamaGrada('${gradovi.getAll()[i].id}','${gradovi.getAll()[i].objekat}')">${gradovi.getAll()[i].objekat}</p>`;
        }
      }

      function obrisiSveGradove(){
        if(brojac==0) return;
        // for(let i=0;i<brojac;i++){
        //   gradovi.removeById(i);
        // }
        gradovi.removeRange(()=>1==1);
        gradovi.brojac=0;
        brojac=0;
        prikaziGradove();
      }

      function popuniPoljaInformacijamaGrada(rbGrada, naziv){
        document.getElementById("odabrani-id").value = rbGrada;
        document.getElementById("odabrani-naziv").value = naziv;
      }


      function obrisiGrad(){
        let rbGrada=document.getElementById("odabrani-id").value;
        gradovi.removeById(rbGrada);
        // gradovi.updateBrojac();
        brojac--;
        prikaziGradove();
      }

      function pogledajPrognozu(){
        let nazivGrada = document.getElementById("odabrani-naziv").value;
        if(!nazivGrada) return;
        // console.log(nazivGrada);
        fetch(`http://api.openweathermap.org/data/2.5/forecast?q=${nazivGrada}&appid=917b026a997320574cd4315b9bf4c73a`)
        .then((res)=>{
          if(res.status!=200)
          alert("Grad ne postoji!");
          res.json().then((body)=>{
            console.log(body);
            let temperatura = Number(Number(body.list[0].main.temp) - 273.15);
            document.getElementById("textTemp").value = temperatura.toFixed(1);
            document.getElementById("textWindSpeed").value = Number(body.list[0].wind.speed).toFixed(1);
            let smjerVjetra = Number(body.list[0].wind.deg)
            document.getElementById("textWindDeg").value = smjerVjetra;
            document.getElementById("strelica").style.rotate = `${smjerVjetra-90}deg`;
            document.getElementById("svg-div").style.color=getBoju(temperatura);

            let tabela = document.getElementById("table");
            for(let i=0;i<body.list.length;i++){
              let datum = new Date();
              // datum.setMilliseconds(Number(body.list[i].dt));
              let smjerVjetra = Number(body.list[i].wind.deg);
              let brzinaVjetra = Number(body.list[i].wind.speed);
              tabela.innerHTML+=
              `<tr>
                <td>${datum.toUTCString()}</td>
                <td>${Number(Number(body.list[i].main.temp) - 273.15).toFixed(1)}</td>
                <td>${body.list[i].weather[0].description}</td>
                <td>${body.list[i].main.humidity} %</td>
                <td><svg id="propeller${i}" style="animation-duration: ${10/brzinaVjetra}s" class="propeller" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="50" cy="50" r="45" fill="lightblue" />
                  <line x1="50" y1="5" x2="50" y2="30" stroke="black" stroke-width="3" />
                  <line x1="50" y1="70" x2="50" y2="95" stroke="black" stroke-width="3" />
                  <line x1="5" y1="50" x2="30" y2="50" stroke="black" stroke-width="3" />
                  <line x1="70" y1="50" x2="95" y2="50" stroke="black" stroke-width="3" />
                  <circle cx="50" cy="50" r="5" fill="black" />
                </svg></td>
               
                <td><img class="strelica" src="strelica.jpg" style="rotate: ${smjerVjetra-90}deg"></td>
                <td>${body.list[i].main.pressure}</td>
                </tr>`
            }
          })
        })
      }

      function getBoju(temperatura){
        if(temperatura<-10)
        return 'rgb(0,0,255)';
      else if(temperatura>=-10 && temperatura<0)
        return 'rgb(112,122,255)';
      else if(temperatura>=0 && temperatura<10)
        return 'rgb(112,237,255)';
      else if(temperatura>=10 && temperatura<20)
        return 'rgb(112,255,165)';
      else if(temperatura>=20 && temperatura<30)
        return 'rgb(242,255,112)';
      else if(temperatura>=30 && temperatura<40)
        return 'rgb(255,134,27)';
      else return 'rgb(255,0,0)';

      }


    </script>




























    <!-- <script>
      let gradovi = new Kolekcija("gradovi");
      let prikazGradova = document.getElementById("gradoviPlaceholder");
      let brojac = 0;

      function zadatak1() {
        let nazivGrada = document.getElementById("unosGrada").value;
        if (!nazivGrada) return;
        console.log(nazivGrada);
        gradovi.add(nazivGrada);
        zadatak2();
      }

      function zadatak2() {
        let grad = document.createElement("p");
        grad.className = "gradListItem";
        grad.innerHTML = gradovi.getAll()[brojac++].objekat;
        console.log(gradovi.findById(gradovi.brojac));
        prikazGradova.appendChild(grad);
      }

      function obrisiSveGradove() {
        for (let i = 0; i < gradovi.brojac; i++) {
          gradovi.removeById(i);
        }
        gradovi.brojac = 0;
        prikazGradova.innerHTML = "";
        brojac = 0;
      } -->
    </script>
  </body>
</html>
